## 1. Общая цель проекта

Разработать учебную реляционную базу данных в PostgreSQL для предметных областей, которая демонстрирует:

- корректное проектирование схемы (связи 1–N, M–N, иерархии);
- использование ограничений целостности (PRIMARY KEY, FOREIGN KEY, UNIQUE, CHECK, DEFAULT);
- работу с обычными и материализованными представлениями (VIEW и MATERIALIZED VIEW);
- написание базовых и аналитических SQL‑запросов.

---

## 2. Требования к схеме базы данных

1. **Количество и состав таблиц**

   В схему должны входить не менее 10 таблиц. 

2. **Ключи и связи**

   - Во всех таблицах есть **первичные ключи** (`primary key`) – обычно `integer not null primary key`.
   - Связи между таблицами оформлены через **FOREIGN KEY** с осмысленными правилами удаления:
     - `on delete restrict` – нельзя удалить запись из родительской таблицы, если на неё есть ссылки (строгая целостность).
   - Реализованы типы связей:
     - **1–N**:
     - **M–N** (через таблицы‑связки):
     - **Иерархия**:

3. **Ограничения и типы данных**

   - Используются основные типы:
     - `integer`, `text`, `char(2)` / `char(3)`, `date`, `timestamptz`, `boolean`, `jsonb`.
   - Основные ограничения:
     - `primary key` – уникальный идентификатор строки;
     - `unique` – запрет дубликатов;
     - `not null` – обязательные поля (id, name, email, и т.д.);
     - `check (...)` – проверка допустимых значений:
       - `account_status in ('active','blocked','deleted')`;
       - `amount_cents >= 0`;
       - `edition_no is null or edition_no >= 1`;
       - `status in ('available','loaned','lost','repair')`, и т.п.;
     - `default`:
       - `created_at default now()` для фиксации времени создания записи;
       - `status default 'active'` / `status default 'unpaid'`;
       - `currency char(3) not null default 'USD'`.
   - Для части сущностей используется `jsonb` для хранения **произвольных метаданных** (`meta_json` в `books` – по аналогии с музыкальным сервисом).

---

## 3. Тестовые данные

1. Для **каждой таблицы** должно быть добавлено несколько записей:

2. Цель тестовых данных:

   - показать работу всех связей (join между таблицами);
   - обеспечить примеры для `group by`, `sum`, `count`, `rank()` и т.п.;
   - продемонстрировать разные состояния (`active`, `canceled`, `expired`, `fulfilled`, `unpaid`, `paid`, `waived`, `available`, `lost`, `repair`).

---
